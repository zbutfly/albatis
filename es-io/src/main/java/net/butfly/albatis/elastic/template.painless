if (ctx._source.{0} == null) ctx._source.{0} = [];
else if (!(ctx._source.{0} instanceof Collection)) ctx._source.{0} = [ctx._source.{0}].flatten().findAll '{' it != null '}';
int i = 0;
for (; i < ctx._source.{0}.size(); i++) if (item.{1} == values.{1}) '{'
	ctx._source.{0}[i] = values;
	break;
'}'

if (i >= ctx._source.{0}.size()) '{'
	ctx._source.{0}.add(values);
'}'
